{% extends "page.html" %}

{% block content %}
<h3>Online Homework Management System (OHMS)</h3>

<div id="homework">

<h3 id="homework_name">{{ homework.name }} (Due: {{
  homework.due_date.strftime("%a, %b %d at %I:%M %p") }} PST)</h3>

<div id="homework_text"></div>

<hr/>

{% for q in homework.questions %}

<div class='question' id='{{q.id}}' points='{{q.points}}'>
  <h3 class='questionName'>Question {{loop.index}}
{% if q.name %}
: {{q.name|safe}}
{% endif %}  
{% if user.type == "admin" %}
    <span class='lead'>[<a href='view_responses?q={{ q.id }}'>View Student Responses</a>]</span>
{% endif %}
  </h3>

  <table class='frame'>
    <tr><td class='score'><strong>This problem is worth {{q.points}} points.</strong></td></tr>
    <tr><td class='alert'><h5>Comments:</h5> <p class='comments' style="white-space: pre-wrap"></p></td></tr>
    <tr><td class='body'>
	{% if user.type == "admin" %}
	<textarea class="source span8" style="display:none;" rows="30">{{q.xml}}</textarea>
	<div class="editable">
	{% endif %}
	{{q|safe}}
	{% if user.type == "admin" %}
	</div>
	{% endif %}
    </td></tr>
  </table>

  <button class='submit' disabled>Submit Response</button>&nbsp; <span class='time'></span>
</div>

<hr/>
{% endfor %}


{% if user.type == "admin" %}
<h3>Add a Question</h3>
<form action="add_question" method="POST">

  <p>Enter XML source code here.</p>

  <input type="hidden" name="hw_id" value={{ homework.id }} />
  <textarea class="span8" name="xml" rows="4"></textarea>

  <p><input type="submit" value="Add Question!"/></p>

</form>
{% endif %}

</div>
{% endblock %}

{% block javascript %}
    <script src="https://tinymce.cachefly.net/4.1/tinymce.min.js"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/item.js?V=1"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/homework.js?V=1"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/question.js?V=1"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/multiplechoiceitem.js?V=1"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/shortansweritem.js?V=1"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/longansweritem.js?V=1"></script>
    <script src="{{options.base_url}}/{{options.static}}/js/hw.js?V=1"></script>
{% endblock %}
